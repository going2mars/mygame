{"version":3,"sources":["../file:/C:/Users/Administrator/NewProject_3/assets/file:/C:/Users/Administrator/NewProject_3/assets/Arrange.ts"],"names":["ccclass","_decorator","property","Arrange","_dec","_dec2","UITransform","_dec3","_dec4","min","step","type","CCInteger","_dec5","_class","_class2","_Component","_inheritsLoose","_this","_len","arguments","length","args","Array","_key","call","apply","concat","_initializerDefineProperty","_descriptor","_assertThisInitialized","_descriptor2","_descriptor3","_descriptor4","_cache","_blocks","_proto","prototype","onLoad","proto","node","active","onDestroy","forEach","v","destroy","start","arrangeBlocks","getBlock","pop","instantiate","getComponent","addComponent","clearBlocks","_this$_cache","push","container","removeAllChildren","blockSize","contentSize","clone","top","height","anchorY","left","width","anchorX","console","log","col","row","y","x","block","parent","setPosition","position","Component","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer","_RF"],"mappings":"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","file":"all.js","sourcesContent":["import { _decorator, assert, CCInteger, Component, instantiate, Node, Prefab, Sprite, SpriteFrame, UITransform } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Arrange')\r\nexport class Arrange extends Component {\r\n    @property(UITransform)\r\n    private readonly container : UITransform;\r\n    @property(UITransform)\r\n    private readonly proto : UITransform;\r\n    @property({ min:1, step:1, type:CCInteger })\r\n    private readonly row = 1;\r\n    @property({ min:1, step:1, type:CCInteger })\r\n    private readonly col = 1;\r\n\r\n    private _cache = [] as UITransform[];\r\n    private _blocks = [] as UITransform[];\r\n\r\n    protected onLoad(): void {\r\n        this.proto.node.active = false;\r\n    }\r\n\r\n    protected onDestroy(): void {\r\n        this._cache.forEach(v => v.node.destroy());\r\n        this._cache.length = 0;\r\n    }\r\n\r\n    protected start(): void {\r\n        this.arrangeBlocks();\r\n    }\r\n\r\n    protected getBlock() : UITransform {\r\n        if (this._cache.length > 0) {\r\n            return this._cache.pop();\r\n        }\r\n        const node = instantiate(this.proto.node);\r\n        return node.getComponent(UITransform) || node.addComponent(UITransform);\r\n    }\r\n\r\n    protected clearBlocks() {\r\n        this._cache.push(...this._blocks);\r\n        this._blocks.forEach(v => v.node.active = false);\r\n        this._blocks.length = 0;\r\n        this.container.node.removeAllChildren();\r\n    }\r\n\r\n    arrangeBlocks() {\r\n        this.clearBlocks();\r\n\r\n        const blockSize = this.proto.contentSize.clone();\r\n        const top = this.container.height * (1 - this.container.anchorY);\r\n        const left = this.container.width * -this.container.anchorX;\r\n\r\n        console.log(`col:${this.col}, row:${this.row}`);\r\n\r\n        for (let y = 0; y < this.row; ++y) {\r\n            for (let x = 0; x < this.col; ++x) {\r\n                const block = this.getBlock();\r\n                console.log(block);\r\n                block.node.active = true;\r\n                block.node.parent = this.container.node;\r\n                block.node.setPosition(\r\n                    left + (x + 0.5) * blockSize.width,\r\n                    top - (y + 0.5) * blockSize.height,\r\n                );\r\n                console.log(block.node.position);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}